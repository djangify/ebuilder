{% load static %}

<nav class="w-full border-b border-[color:var(--color-accent)] bg-white shadow-sm"
     role="navigation"
     aria-label="Main navigation">

  <div class="max-w-7xl mx-auto px-6 lg:px-10 flex justify-between items-center h-20">
    
    <!-- Logo + Business Name -->
    <a href="{{ HOME_URL }}" class="flex items-center gap-2"
       aria-label="{{ homepage_settings.business_name|default:'Home' }}">
      {% if homepage_settings.logo_image %}
        <img src="{{ homepage_settings.logo_image.url }}"
             alt="{{ homepage_settings.business_name }}"
             class="h-10 w-auto object-contain"
             loading="lazy">
      {% endif %}
      
        {% if homepage_settings.logo_image %}
        <img src="{{ homepage_settings.logo_image.url }}"
             alt="{{ homepage_settings.business_name }}"
             class="h-10 w-auto object-contain"
             loading="lazy">
      {% endif %}
      <span class="hidden md:flex text-[color:var(--color-font-main)] font-semibold uppercase tracking-wide">
        {{ homepage_settings.business_name }}
      </span>
    </a>

    <!-- Desktop Navigation -->
    <ul class="hidden md:flex items-center gap-10 text-sm font-medium uppercase">

      <!-- Dynamic Pages -->
      {% for p in published_pages %}
      <li>
        <a href="{{ p.get_absolute_url }}"
           class="text-[color:var(--color-font-main)] hover:text-[color:var(--color-secondary)] transition">
          {{ p.title }}
        </a>
      </li>
      {% endfor %}

      <!-- Shop (always shown) -->
      <li>
        <a href="{% url 'shop:product_list' %}"
           class="text-[color:var(--color-font-main)] hover:text-[color:var(--color-secondary)] transition">
          Shop
        </a>
      </li>
    </ul>

    <!-- Right-Side Buttons -->
    <div class="flex items-center gap-5">
      {% if not request.user.is_authenticated %}
      <a href="{% url 'account_login' %}"
         class="uppercase border bg-[color:var(--color-light)] border-[color:var(--color-accent)] text-[color:var(--color-font-main)] text-xs sm:text-sm px-5 py-2 rounded font-bold hover:bg-[color:var(--color-secondary)] hover:border-[color:var(--color-secondary)] hover:text-[color:var(--color-light)] transition">
        Login
      </a>
      {% else %}
      <a href="{% url 'account_logout' %}"
         class="uppercase border bg-[color:var(--color-accent)] border-[color:var(--color-accent)] text-[color:var(--color-font-main)] text-xs sm:text-sm px-5 py-2 rounded font-bold hover:bg-[color:var(--color-secondary)] hover:text-[color:var(--color-light)]">
        Logout
      </a>
      {% endif %}

      <!-- Mobile Menu Button -->
      <button 
        id="menu-toggle"
        class="md:hidden flex flex-col justify-between w-8 h-6 focus:outline-none"
        aria-label="Toggle menu"
        aria-expanded="false"
        aria-controls="mobile-menu"
      >
        <span class="block h-0.5 w-full bg-[color:var(--color-font-main)] rounded"></span>
        <span class="block h-0.5 w-full bg-[color:var(--color-font-main)] rounded"></span>
        <span class="block h-0.5 w-full bg-[color:var(--color-font-main)] rounded"></span>
      </button>
    </div>
  </div>

  <!-- MOBILE NAVIGATION -->
  <div id="mobile-menu"
       class="hidden flex-col items-center bg-[color:var(--color-light)] border-t border-[color:var(--color-accent)] py-4 space-y-4 md:hidden">

    <!-- Dynamic pages -->
    {% for p in published_pages %}
    <a href="{{ p.get_absolute_url }}"
       class="block w-full text-center py-2 text-lg text-[color:var(--color-font-main)] hover:text-[color:var(--color-primary)] transition">
      {{ p.title }}
    </a>
    {% endfor %}

    <!-- Shop (always shown) -->
    <a href="{% url 'shop:product_list' %}"
       class="block w-full text-center py-2 text-lg text-[color:var(--color-font-main)] hover:text-[color:var(--color-primary)] transition">
      Shop
    </a>

    {% if not request.user.is_authenticated %}
    <a href="{% url 'account_login' %}"
       class="block w-full text-center py-2 text-lg text-[color:var(--color-font-main)] hover:text-[color:var(--color-primary)]">
      Login
    </a>
    {% else %}
    <a href="{% url 'account_logout' %}"
       class="block w-full text-center py-2 text-lg text-[color:var(--color-font-main)] hover:text-[color:var(--color-primary)]">
      Logout
    </a>
    {% endif %}
  </div>

  <!-- Mobile Toggle Script -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const toggle = document.getElementById("menu-toggle");
      const menu = document.getElementById("mobile-menu");

      toggle.addEventListener("click", () => {
        menu.classList.toggle("hidden");
        const expanded = toggle.getAttribute("aria-expanded") === "true";
        toggle.setAttribute("aria-expanded", !expanded);
      });
    });
  </script>

</nav>
